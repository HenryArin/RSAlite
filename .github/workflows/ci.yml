name: C Build and Tests

on:
  push:
  pull_request:

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source
        uses: actions/checkout@v3

      - name: Build with Make
        run: make

      # Test 1: trial division with 55 (expects 5 and 11)
      - name: Test trail_division with 55
        run: |
          printf "55\n1\n" | ./rsalite > output.txt
          grep "5 is a prime factor of 55" output.txt
          grep "11 is a prime factor of 55" output.txt

      # Test 2: square root method with 55 (expects 5 and 11)
      - name: Test square_root with 55
        run: |
          printf "55\n2\n" | ./rsalite > output.txt
          grep "5 is a prime factor of 55" output.txt
          grep "11 is a prime factor of 55" output.txt

      # Test 3: simple prime, e.g., 13 (expects only 13)
      - name: Test prime number (13)
        run: |
          printf "13\n1\n" | ./rsalite > output.txt
          grep "13 is a prime factor of 13" output.txt
